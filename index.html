<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>半斤</title>
  
    <link rel="icon" href="/assets/github.svg">
  
  
  
  <!--link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css"-->
  
<link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css">

  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
<div class="Shell">
    <aside class='SideBar'>
    <section class='avatar' style="background-image: url(/assets/header.png)">
        <div class='av-pic' style="background-image: url(/assets/tree_small.png)">
        </div>
    </section>
    <section class='menu'>
        <div>半斤</div>
        
        <ul>
          
            <a href="/" class="Btn">
              <li>Home</li>
            </a>  
          
            <a href="/archives/" class="Btn">
              <li>Archive</li>
            </a>  
          
            <a href="/tags/" class="Btn">
              <li>Tags</li>
            </a>  
          
            <a href="/about/" class="Btn">
              <li>About</li>
            </a>  
          
        </ul>
    </section>
    <section class="media">
        
    </section>
</aside>

    <div class="container">
        <div data-pager-shell>
            <ul class="Index">
  
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/10/10/BOOKS-NOTE/">BOOKS NOTE</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-10-10T07:40:16.000Z" itemprop="datePublished">
    2021-10-10
  </time>
  
  
</div>

    </header>
    <div>
      
        <h1 id="BOOKS-NOTE"><a href="#BOOKS-NOTE" class="headerlink" title="BOOKS NOTE"></a>BOOKS NOTE</h1><hr>

<h3 id="《双子星》"><a href="#《双子星》" class="headerlink" title="《双子星》"></a>《双子星》</h3><pre><code>        -- 伊坂幸太郎【日】 著
</code></pre>
<blockquote>
<p>&ensp;&ensp;&ensp;&ensp;大婶缓缓转过头来，深深叹了口气：“优我，你脑子好使，肯定也知道借钱本身根本不是问题。我想说的是，谈钱需要相应的觉悟，它有可能破坏我跟你们之间的关系。你们明白这一点，却还想找我借钱，这让我心里不是滋味呀。借钱倒是没什么。”<br>&ensp;&ensp;&ensp;&ensp;我和风我深深地低下了头。<br>&ensp;&ensp;&ensp;&ensp;再多得辩解和歉意都没有意义了。<br>&ensp;&ensp;&ensp;&ensp;或许我们和大婶的关系会因此生隙，但总有一天裂痕会修复，我们会弥补她的。<br>&ensp;&ensp;&ensp;&ensp;我认为这样，风我肯定也一样。<br>&ensp;&ensp;&ensp;&ensp;最终借了两百万日元。<br>&ensp;&ensp;&ensp;&ensp;摞起来也没有多厚，甚至有些叫人失望。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 🐘  我也会这么觉得。&lt; 2021-10-10 16:01 &gt;</span></span><br></pre></td></tr></table></figure>

<hr>
      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/10/07/laravel%E4%BD%BF%E7%94%A8Casbin%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BARBAC/">laravel使用Casbin快速搭建RBAC</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-10-07T08:46:27.000Z" itemprop="datePublished">
    2021-10-07
  </time>
  
  
</div>

    </header>
    <div>
      
        <h1 id="laravel使用Casbin快速搭建RBAC"><a href="#laravel使用Casbin快速搭建RBAC" class="headerlink" title="laravel使用Casbin快速搭建RBAC"></a>laravel使用Casbin快速搭建RBAC</h1><p>github地址：<a target="_blank" rel="noopener" href="https://github.com/php-casbin/laravel-authz">https://github.com/php-casbin/laravel-authz</a></p>
<p>laravel 项目安装</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">composer require casbin/laravel-authz</span><br></pre></td></tr></table></figure>
<p>添加服务提供者</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// config/app.php</span><br><span class="line">&#x27;providers&#x27; =&gt; [</span><br><span class="line">    /*</span><br><span class="line">     * Package Service Providers...</span><br><span class="line">     */</span><br><span class="line">    Lauthz\LauthzServiceProvider::class,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#x27;aliases&#x27; =&gt; [</span><br><span class="line">    // ...</span><br><span class="line">    &#x27;Enforcer&#x27; =&gt; Lauthz\Facades\Enforcer::class,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>发布</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php artisan vendor:publish</span><br><span class="line"></span><br><span class="line">// 弹出选项</span><br><span class="line">Which provider or tag&#x27;s files would you like to publish?:</span><br><span class="line">  [0 ] Publish files from all providers and tags listed below</span><br><span class="line">  [1 ] Provider: BeyondCode\DumpServer\DumpServerServiceProvider</span><br><span class="line">  [2 ] Provider: Fideloper\Proxy\TrustedProxyServiceProvider</span><br><span class="line">  [3 ] Provider: Illuminate\Foundation\Providers\FoundationServiceProvider</span><br><span class="line">  [4 ] Provider: Illuminate\Mail\MailServiceProvider</span><br><span class="line">  [5 ] Provider: Illuminate\Notifications\NotificationServiceProvider</span><br><span class="line">  [6 ] Provider: Illuminate\Pagination\PaginationServiceProvider</span><br><span class="line">  [7 ] Provider: Laravel\Tinker\TinkerServiceProvider</span><br><span class="line">  [8 ] Provider: Lauthz\LauthzServiceProvider</span><br><span class="line">  [9 ] Provider: Tymon\JWTAuth\Providers\LaravelServiceProvider</span><br><span class="line">  [10] Tag: config</span><br><span class="line">  [11] Tag: laravel-errors</span><br><span class="line">  [12] Tag: laravel-lauthz-config</span><br><span class="line">  [13] Tag: laravel-lauthz-migrations</span><br><span class="line">  [14] Tag: laravel-mail</span><br><span class="line">  [15] Tag: laravel-notifications</span><br><span class="line">  [16] Tag: laravel-pagination</span><br><span class="line"> &gt; 12</span><br><span class="line"></span><br><span class="line">// 输入12，生成配置</span><br><span class="line">Copied File [/vendor/casbin/laravel-authz/config/lauthz-rbac-model.conf] To [/config/lauthz-rbac-model.conf]</span><br><span class="line">Copied File [/vendor/casbin/laravel-authz/config/lauthz.php] To [/config/lauthz.php]</span><br><span class="line">Publishing complete.</span><br><span class="line"></span><br><span class="line">// 再次操作，输入13，生成迁移数据文件</span><br><span class="line">Copied Directory [/vendor/casbin/laravel-authz/database/migrations] To [/database/migrations]</span><br><span class="line">Publishing complete.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>迁移数据创建一个名为 rules 的新表</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php artisan migrate</span><br></pre></td></tr></table></figure>

<h4 id="用法-Enforcer-Api"><a href="#用法-Enforcer-Api" class="headerlink" title="用法 Enforcer Api"></a>用法 Enforcer Api</h4><p>获取所有角色</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Enforcer::getAllRoles(); // [&#x27;writer&#x27;, &#x27;reader&#x27;]</span><br></pre></td></tr></table></figure>

<p>获取用户拥有的角色</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Enforcer::getRolesForUser(&#x27;eve&#x27;); // [&#x27;writer&#x27;]</span><br></pre></td></tr></table></figure>


      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/10/04/laravel-api-init/">laravel-api-init</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-10-04T02:51:46.000Z" itemprop="datePublished">
    2021-10-04
  </time>
  
  
</div>

    </header>
    <div>
      
        <h1 id="Laravel-api-init"><a href="#Laravel-api-init" class="headerlink" title="Laravel-api-init"></a>Laravel-api-init</h1><blockquote>
<p>使用auth-jwt，安装 <a target="_blank" rel="noopener" href="https://jwt-auth.readthedocs.io/en/develop/laravel-installation/">https://jwt-auth.readthedocs.io/en/develop/laravel-installation/</a></p>
</blockquote>
<p>请求me接口时报错,重定向到login路由时找不到（因为只做api,路由找的是web的登录页），可以重写路由，提示权限验证有误。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># App\Http\Middleware\Authenticate</span><br><span class="line">protected function redirectTo($request)</span><br><span class="line">&#123;</span><br><span class="line">    if (!$request-&gt;expectsJson()) &#123;</span><br><span class="line">        return route(&#x27;re-login&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># router这样写</span><br><span class="line">Route::get(&#x27;re-login&#x27;,&#x27;APi\UserController@re_login&#x27;)-&gt;name(&#x27;re-login&#x27;); //校验失败，重新登录</span><br><span class="line"></span><br><span class="line"># 提示方法</span><br><span class="line">public function re_login()</span><br><span class="line">&#123;</span><br><span class="line">    return response()-&gt;json([&#x27;msg&#x27; =&gt; &#x27;验证过期或有误，请重新登录&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>测试工具使用Apifox <a target="_blank" rel="noopener" href="https://www.apifox.cn/help/#%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E7%8E%B0%E7%8A%B6">https://www.apifox.cn/help/#%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E7%8E%B0%E7%8A%B6</a> , 用postman也是一样的</p>
</blockquote>
<h4 id="OAuth2-0"><a href="#OAuth2-0" class="headerlink" title="OAuth2.0"></a>OAuth2.0</h4><ul>
<li>授权码<br>  第三方应用先获取授权码，再用授权码去获取令牌。</li>
<li>隐藏式<br>  没有后端的纯前端项目，直接请求获取令牌，令牌发送是以锚点的方式带过来的，因为http协议可能遭到中间人攻击。</li>
<li>密码式<br>  高度信任某个应用，直接要求用户提供账户密码，拿到帐密后就直接请求令牌。</li>
<li>凭证式<br>  适用于没有前端的命令行应用。直接拿凭证请求，验证通过后立即返回令牌。这种方式给出的令牌，是针对第三方应用的，而不是针对用户的，即有可能多个用户共享同一个令牌。</li>
</ul>
<h3 id="Laravel-Api表单验证失败被重定向到主页"><a href="#Laravel-Api表单验证失败被重定向到主页" class="headerlink" title="Laravel Api表单验证失败被重定向到主页"></a>Laravel Api表单验证失败被重定向到主页</h3><p>查看fromrequest源码，有一个方法failedValidation，失败后会重定向到指定路由。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line">* Handle a failed validation attempt.</span><br><span class="line">*</span><br><span class="line">* @param  \Illuminate\Contracts\Validation\Validator  $validator</span><br><span class="line">* @return void</span><br><span class="line">*</span><br><span class="line">* @throws \Illuminate\Validation\ValidationException</span><br><span class="line">*/</span><br><span class="line">protected function failedValidation(Validator $validator)</span><br><span class="line">&#123;</span><br><span class="line">    throw (new ValidationException($validator))</span><br><span class="line">                -&gt;errorBag($this-&gt;errorBag)</span><br><span class="line">                -&gt;redirectTo($this-&gt;getRedirectUrl());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以把它重写成返回指定的json串。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">protected function failedValidation(Validator $validator)</span><br><span class="line">&#123;</span><br><span class="line">    $validator = new ValidationException($validator);</span><br><span class="line">    throw new HttpResponseException(response()-&gt;json([</span><br><span class="line">        &#x27;message&#x27; =&gt; $validator-&gt;getMessage(),</span><br><span class="line">        &#x27;error&#x27; =&gt; $validator-&gt;errors()</span><br><span class="line">    ], JsonResponse::HTTP_UNPROCESSABLE_ENTITY));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    // 重写验证失败 返回错误信息（本来是跳转指定路由</span><br><span class="line">    protected function failedValidation(Validator $validator)</span><br><span class="line">    &#123;</span><br><span class="line">        // 422 Unprocessable Entity 请求格式正确，但是由于含有语义错误，无法响应。</span><br><span class="line">        $validator = new ValidationException($validator);</span><br><span class="line">//        throw new HttpResponseException(response()-&gt;json([</span><br><span class="line">//            &#x27;message&#x27; =&gt; $validator-&gt;getMessage(),</span><br><span class="line">//            &#x27;error&#x27; =&gt; $validator-&gt;errors()</span><br><span class="line">//        ], JsonResponse::HTTP_UNPROCESSABLE_ENTITY));</span><br><span class="line">        $message = array_values(array_map(&#x27;reset&#x27;, objToArr($validator-&gt;errors())))[0] ?? $validator-&gt;getMessage();</span><br><span class="line">        $response_arr = $this-&gt;failed($message, $validator-&gt;status);</span><br><span class="line">        throw new HttpResponseException($response_arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Laravel-添加公共函数"><a href="#Laravel-添加公共函数" class="headerlink" title="Laravel 添加公共函数"></a>Laravel 添加公共函数</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/crazytata/p/10135841.html">https://www.cnblogs.com/crazytata/p/10135841.html</a></p>
</blockquote>
<h4 id="Laravel-对象转数组"><a href="#Laravel-对象转数组" class="headerlink" title="Laravel 对象转数组"></a>Laravel 对象转数组</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">toArray() 之后</span><br><span class="line">array_map (&#x27;get_object_vars&#x27;, $results); </span><br><span class="line">// or</span><br><span class="line">json_decode(json_encode($array,true),true)</span><br></pre></td></tr></table></figure>

<h4 id="获取一组数组数据的头或结尾列"><a href="#获取一组数组数据的头或结尾列" class="headerlink" title="获取一组数组数据的头或结尾列"></a>获取一组数组数据的头或结尾列</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$arr2 = array_map(&#x27;reset&#x27;,$arr);</span><br><span class="line">$arr2 = array_map(&#x27;end&#x27;,$arr);</span><br></pre></td></tr></table></figure>
<h4 id="Laravel-api-访问频率限制-429-Too-many-requests"><a href="#Laravel-api-访问频率限制-429-Too-many-requests" class="headerlink" title="Laravel api 访问频率限制 429 Too many requests"></a>Laravel api 访问频率限制 429 Too many requests</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 配置在 Laravel 项目文件 app/Http/Kernel.php</span><br><span class="line">&#x27;api&#x27; =&gt; [</span><br><span class="line">    &#x27;throttle:60,1&#x27;,</span><br><span class="line">    &#x27;bindings&#x27;,·</span><br><span class="line">],</span><br><span class="line">/*</span><br><span class="line">第一个参数 60 代表每分钟限制 60 次请求</span><br><span class="line">第二个参数 1 代表触发了限制规则，则1分钟内禁止访问</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<h4 id="解决并发请求-token-失效的问题·······"><a href="#解决并发请求-token-失效的问题·······" class="headerlink" title="解决并发请求 token 失效的问题·······"></a>解决并发请求 token 失效的问题·······</h4><blockquote>
<p>配置 blacklist_grace_period 参数，允许过期 token 在一定时间内访问·</p>
</blockquote>

      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/08/13/go%E6%8A%A5%E9%94%99%E5%8E%9F%E5%9B%A0/">go报错原因</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-08-13T08:26:51.000Z" itemprop="datePublished">
    2021-08-13
  </time>
  
  
</div>

    </header>
    <div>
      
        <h2 id="go报错原因"><a href="#go报错原因" class="headerlink" title="go报错原因"></a>go报错原因</h2><ul>
<li><p><code>no result values expected</code><br>  函数没有写返回值，却进行了return</p>
</li>
<li><p><code>undeclared name: xx</code><br>  为定义的变量名，注意定义时的 : 有没有写</p>
</li>
</ul>

      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/08/04/go%E5%88%87%E7%89%87%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E5%9C%B0%E6%96%B9/">go切片需要注意的地方</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-08-04T02:55:22.000Z" itemprop="datePublished">
    2021-08-04
  </time>
  
  
</div>

    </header>
    <div>
      
        <h3 id="有关于切片slice"><a href="#有关于切片slice" class="headerlink" title="有关于切片slice"></a>有关于切片slice</h3><ul>
<li>在go语言中，数组其实是不经常使用的，因为它在函数传参时默认使用的是值传递（复制本身的值再传递给函数内，若是这个数组非常大，将会十分消耗内存资源，且在函数内对数组做出的改变不会影响到数组数据本身）；经常使用的是切片，就是slice。</li>
</ul>
<ul>
<li><p>其slice在作为函数参数时是引用传递，在函数内对其做的操作会影响到数据本身。</p>
</li>
<li><p>slice的取值操作遵循半封闭原则，比如取值<code>[2:6]</code>，取2的数据，第5个取完就停止了，不会取6的数据。</p>
</li>
</ul>
<p><strong><code>slice本身是没有数据的，底层是对数组的一个view（视图）</code></strong></p>
<ul>
<li>数组想要传递到参数是切片的函数，可以这么写<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    arr := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line">    updateArray(arr[:])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateArray</span><span class="params">(a []<span class="keyword">int</span>)</span></span>&#123;</span><br><span class="line">    <span class="comment">// to do ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
这样当你在函数内修改数组的数据时，数组本身的数据也会跟着改变</li>
</ul>
<h3 id="slice-的扩展"><a href="#slice-的扩展" class="headerlink" title="slice 的扩展"></a>slice 的扩展</h3><p>先看例子</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">arr := [...]<span class="keyword">int</span>&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;</span><br><span class="line">s1 := arr[<span class="number">2</span>:<span class="number">6</span>]</span><br><span class="line">s2 := s1[<span class="number">3</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure>
<p>这时，请问s1,s2的值分别是多少?<br>在s1中只有4个数值，根本不满足5的下标取值，按理说s2的取值应该会报错，但是确实能够取到，打印出来如下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">s1= [<span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span>]</span><br><span class="line">s2= [<span class="number">5</span> <span class="number">6</span>]</span><br></pre></td></tr></table></figure>
<p>如果单独取5<code>s2[5]</code>会报错</p>
<p>因为slice的数据结构是由ptr(指针)，len（长度），cap（容量）组成的，当它去掉前面的下标后，会扩展余下的内容，但是不会展示出来，当你用切片取值超出len的长度的时候它会自行判断是否由足够的容量还存着其他的值，若是有就会返回出来。这个就是它的扩展性，注意它只能扩展后面的，不能扩展前面的，且扩展的数组不能超过容量。</p>

      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/08/04/go%E4%B8%A4%E4%B8%AA%E6%95%B0%E5%80%BC%E4%BA%A4%E6%8D%A2/">go两个数值交换</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-08-03T16:10:10.000Z" itemprop="datePublished">
    2021-08-04
  </time>
  
  
</div>

    </header>
    <div>
      
        <p>关于go两个数值交换，第一个想到的应该是使用指针的方式</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    a,b:=<span class="number">3</span>,<span class="number">4</span></span><br><span class="line">    swap(&amp;a,&amp;b)</span><br><span class="line">    fmt.Println(a,b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swap</span><span class="params">(a,b *<span class="keyword">int</span>)</span></span>&#123;</span><br><span class="line">    *a,*b = *b,*a</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也可以借助中间变量来作交换</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    a,b:=<span class="number">3</span>,<span class="number">4</span></span><br><span class="line">    swap(&amp;a,&amp;b)</span><br><span class="line">    fmt.Println(a,b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swap</span><span class="params">(a,b *<span class="keyword">int</span>)</span></span>&#123;</span><br><span class="line">    tmp := *a</span><br><span class="line">	*a = *b</span><br><span class="line">	*b = tmp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还有一种方式，可以不用到指针也能交换；不过这里要注意一下需要有返回值，和需要取接受返回值</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a, b := <span class="number">3</span>, <span class="number">4</span></span><br><span class="line">	swap(a, b)</span><br><span class="line">	fmt.Println(a, b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swap</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> b, a</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/07/27/failed/">git克隆rpc failed</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-07-27T05:06:05.000Z" itemprop="datePublished">
    2021-07-27
  </time>
  
  
</div>

    </header>
    <div>
      
        <h1 id="git-克隆报错-error-RPC-failed"><a href="#git-克隆报错-error-RPC-failed" class="headerlink" title="git 克隆报错 error: RPC failed"></a>git 克隆报错 error: RPC failed</h1><p><code>git config --global http.sslVerify false</code></p>
<hr>
<p><code>git config --list </code></p>
<p>看 <code>http.postbuffer</code> 参数是否设置，可以设置为 5242880000</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git config --global http.postBuffer 5242880000</span><br></pre></td></tr></table></figure>
      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/07/26/go%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/">go依赖管理工具</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-07-26T02:05:54.000Z" itemprop="datePublished">
    2021-07-26
  </time>
  
  
</div>

    </header>
    <div>
      
        <h1 id="glide"><a href="#glide" class="headerlink" title="glide"></a>glide</h1><h3 id="go依赖包管理工具-glide"><a href="#go依赖包管理工具-glide" class="headerlink" title="go依赖包管理工具 glide"></a>go依赖包管理工具 glide</h3><p><a target="_blank" rel="noopener" href="https://glidedocs.readthedocs.io/zh/latest/">glide中文文档</a></p>
<p>glide.yaml 完整配置示例</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">package:</span> <span class="string">foor</span></span><br><span class="line"><span class="attr">homepage:</span> <span class="string">https://github.com/qiangmzsx</span></span><br><span class="line"><span class="attr">license:</span> <span class="string">MIT</span></span><br><span class="line"><span class="attr">owners:</span> </span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qiangmzsx</span></span><br><span class="line">  <span class="attr">email:</span> <span class="string">qiangmzsx@hotmail.com</span></span><br><span class="line">  <span class="attr">homepage:</span> <span class="string">https://github.com/qiangmzsx</span></span><br><span class="line"><span class="comment"># 去除包</span></span><br><span class="line"><span class="attr">ignore:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">appengine</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">golang.org/x/net</span></span><br><span class="line"><span class="comment"># 排除目录</span></span><br><span class="line"><span class="attr">excludeDirs:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">node_modules</span></span><br><span class="line"><span class="comment"># 导入包</span></span><br><span class="line"><span class="attr">import:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">package:</span> <span class="string">github.com/astaxie/beego</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">1.8</span><span class="number">.0</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">package:</span> <span class="string">github.com/coocood/freecache</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">package:</span> <span class="string">github.com/garyburd/redigo/redis</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">package:</span> <span class="string">github.com/go-sql-driver/mysql</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">package:</span> <span class="string">github.com/bitly/go-simplejson</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">package:</span> <span class="string">git.oschina.net/qiangmzsx/beegofreecache</span></span><br><span class="line"><span class="attr">testImport:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">package:</span> <span class="string">github.com/smartystreets/goconvey</span></span><br><span class="line">  <span class="attr">subpackages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">convey</span></span><br></pre></td></tr></table></figure>

<p>glide清除缓存 <code>glide cc</code><br>glide更新 <code>glide up</code></p>
<ul>
<li>修改yaml文件添加包， <code>glide up</code></li>
<li>使用<code>glide get github.com/user/projiect</code>命令来添加依赖包</li>
<li>当有glide.lock文件的时候可以使用 <code>glide install</code> 来安装依赖包</li>
</ul>
<hr>
<h1 id="dep"><a href="#dep" class="headerlink" title="dep"></a>dep</h1><h3 id="Mac安装go依赖管理工具-dep"><a href="#Mac安装go依赖管理工具-dep" class="headerlink" title="Mac安装go依赖管理工具 dep"></a>Mac安装go依赖管理工具 dep</h3><blockquote>
<p>go版本要&gt;=1.9<br>dep使用需要fanqiang</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">brew install dep</span><br></pre></td></tr></table></figure>

<p>安装完成,dep命令输出</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Dep is a tool <span class="keyword">for</span> managing dependencies <span class="keyword">for</span> Go projects</span><br><span class="line"></span><br><span class="line">Usage: <span class="string">&quot;dep [command]&quot;</span></span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line"></span><br><span class="line">  init     Set up a new Go project, or migrate an existing one</span><br><span class="line">  status   Report the status of the project<span class="string">&#x27;s dependencies</span></span><br><span class="line"><span class="string">  ensure   Ensure a dependency is safely vendored in the project</span></span><br><span class="line"><span class="string">  version  Show the dep version information</span></span><br><span class="line"><span class="string">  check    Check if imports, Gopkg.toml, and Gopkg.lock are in sync</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Examples:</span></span><br><span class="line"><span class="string">  dep init                               set up a new project</span></span><br><span class="line"><span class="string">  dep ensure                             install the project&#x27;</span>s dependencies</span><br><span class="line">  dep ensure -update                     update the locked versions of all dependencies</span><br><span class="line">  dep ensure -add github.com/pkg/errors  add a dependency to the project</span><br><span class="line"></span><br><span class="line">Use <span class="string">&quot;dep help [command]&quot;</span> <span class="keyword">for</span> more information about a <span class="built_in">command</span>.</span><br></pre></td></tr></table></figure>

<h4 id="使用dep命令安装gin"><a href="#使用dep命令安装gin" class="headerlink" title="使用dep命令安装gin"></a>使用dep命令安装gin</h4><blockquote>
<p>在 GOPATH/src 目录中使用 dep 命令</p>
</blockquote>
<p>新建任意目录，并在里面 dep init，成功后会生成两个文件（Gopkg.lock Gopkg.toml）和一个目录（vendor）</p>
<p><img src="https://gss0.baidu.com/9rkZbzqaKgQUohGko9WTAnF6hhy/mms-res/voice/choujiang/28968009-f49a4a6a-78eb-11e7-93cf-e695d45488da.14d8c0f3.png" alt="relation"></p>
<ul>
<li>vendor 依赖包会下载到这里</li>
<li>Gopkg.lock 暂时不用管</li>
<li>Gopkg.toml 需要的依赖配置写在这里</li>
</ul>
<p>在 toml 文件中增加依赖配置</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line">[[<span class="string">constraint</span>]]</span><br><span class="line">  <span class="string">name</span> <span class="string">=</span> <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">  <span class="string">version</span> <span class="string">=</span> <span class="string">&quot;1.4.0&quot;</span></span><br></pre></td></tr></table></figure>

<p>dep清除缓存<code>rm -rf $GOPATH/pkg/dep/source/</code></p>
<p>之后执行 dep ensure 命令，会在vendor下安装包</p>

      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/07/25/go-mod%E5%BC%95%E5%85%A5%E5%8C%85/">go-mod引入包</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-07-25T05:19:37.000Z" itemprop="datePublished">
    2021-07-25
  </time>
  
  
</div>

    </header>
    <div>
      
        <blockquote>
<p>此方式需要将你的GO111MODULE设置成on,这样你就可以在任意目录下面开启你的项目了</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">随便找个目录下, 新建godemo</span></span><br><span class="line">mkdir godemo</span><br><span class="line">cd godemo</span><br><span class="line"><span class="meta">#</span><span class="bash">初始化go mod</span></span><br><span class="line">go mod init godemo</span><br></pre></td></tr></table></figure>

<p>此时目录下就出现 <code>go.mod</code> 文件，打开查看</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">module godemo</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.16</span></span><br></pre></td></tr></table></figure>
<hr>
<p>新建文件<code>main.go</code>, 在import中写入想要引用的包<br>我这里使用decimal包<br>decimal包地址：<a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/shopspring/decimal">https://pkg.go.dev/github.com/shopspring/decimal</a></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/shopspring/decimal&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	price, err := decimal.NewFromString(<span class="string">&quot;136.02&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	quantity := decimal.NewFromInt(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">	fee, _ := decimal.NewFromString(<span class="string">&quot;.035&quot;</span>)</span><br><span class="line">	taxRate, _ := decimal.NewFromString(<span class="string">&quot;.08875&quot;</span>)</span><br><span class="line"></span><br><span class="line">	subtotal := price.Mul(quantity)</span><br><span class="line"></span><br><span class="line">	preTax := subtotal.Mul(fee.Add(decimal.NewFromFloat(<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">	total := preTax.Mul(taxRate.Add(decimal.NewFromFloat(<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;Subtotal:&quot;</span>, subtotal)                      <span class="comment">// Subtotal: 408.06</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;Pre-tax:&quot;</span>, preTax)                         <span class="comment">// Pre-tax: 422.3421</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;Taxes:&quot;</span>, total.Sub(preTax))                <span class="comment">// Taxes: 37.482861375</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;Total:&quot;</span>, total)                            <span class="comment">// Total: 459.824961375</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;Tax rate:&quot;</span>, total.Sub(preTax).Div(preTax)) <span class="comment">// Tax rate: 0.08875</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>此时运行go run main.go会报错</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">main.<span class="keyword">go</span>:<span class="number">5</span>:<span class="number">2</span>: no required module provides <span class="keyword">package</span> github.com/shopspring/decimal; to add it:</span><br><span class="line">	<span class="keyword">go</span> get github.com/shopspring/decimal</span><br></pre></td></tr></table></figure>
<p>提示使用  <code>go get github.com/shopspring/decimal</code> 命令，使用会显示下载完成<br>再运行就成功</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">go</span> run main.<span class="keyword">go</span></span><br><span class="line"></span><br><span class="line">#输出</span><br><span class="line">Subtotal: <span class="number">408.06</span></span><br><span class="line">Pre-tax: <span class="number">422.3421</span></span><br><span class="line">Taxes: <span class="number">37.482861375</span></span><br><span class="line">Total: <span class="number">459.824961375</span></span><br><span class="line">Tax rate: <span class="number">0.08875</span></span><br></pre></td></tr></table></figure>


      
    </div>
</article>

    </li>
  
    <li>
      <article class='ListView'>
    <header class="title">
      
        <h1>
          <a href="/2021/07/01/go-study/">go环境搭建（Mac）</a>
        </h1>
      
      <div class='ListMeta'>
  <time datetime="2021-06-30T16:22:33.000Z" itemprop="datePublished">
    2021-07-01
  </time>
  
  
</div>

    </header>
    <div>
      
        <h2 id="go环境搭建（Mac）"><a href="#go环境搭建（Mac）" class="headerlink" title="go环境搭建（Mac）"></a>go环境搭建（Mac）</h2><ol>
<li>下载pkg文件进行安装<br><a target="_blank" rel="noopener" href="https://studygolang.com/dl">go语言中文网下载地址</a></li>
<li>设置环境变量<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#编辑.bash_profile文件</span><br><span class="line">vim ~/.bash_profile</span><br><span class="line"></span><br><span class="line">#追加如下配置</span><br><span class="line">export GOROOT=/usr/local/go</span><br><span class="line">#GOPATH是自己的go项目路径，自定义设置</span><br><span class="line">export GOPATH=/Users/molin/Documents/go</span><br><span class="line">export GOBIN=$GOROOT/bin</span><br><span class="line">export PATH=$PATH:$GOBIN/usr/local/go</span><br><span class="line"></span><br><span class="line">#生效</span><br><span class="line">source ~/.bash_profile</span><br><span class="line"></span><br><span class="line">#查看go环境变量</span><br><span class="line">go env</span><br><span class="line"></span><br><span class="line">#查看go版本</span><br><span class="line">go version</span><br></pre></td></tr></table></figure></li>
<li>为go设置工作目录<br> 目录内新建三个文件夹，分别是 bin pkg src</li>
</ol>

      
    </div>
</article>

    </li>
  
</ul>

  <section id="nav-wrapper">
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">next »</a>
    </nav>
  </section>


            <footer>
    <div>© 2021 - 八两 </div>
    <div>
        <span>
            Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
        </span>
        ,
        <span>
            Theme - <a target="_blank" rel="noopener" href="https://github.com/nameoverflow/hexo-theme-icalm">Icalm</a>
        </span>
    </div>
</footer>

        </div>
    </div>
</div>

<script src="/js/pager/singlepager.js"></script>

<script>
var sp = new Pager('data-pager-shell')

</script>
</body>
</html>